<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-design/data-modeling" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Data Modeling | TigerBeetle Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.tigerbeetle.com/design/data-modeling"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Data Modeling | TigerBeetle Docs"><meta data-rh="true" name="description" content="TigerBeetle is a domain-specific database — its schema of Accounts and"><meta data-rh="true" property="og:description" content="TigerBeetle is a domain-specific database — its schema of Accounts and"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.tigerbeetle.com/design/data-modeling"><link data-rh="true" rel="alternate" href="https://docs.tigerbeetle.com/design/data-modeling" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.tigerbeetle.com/design/data-modeling" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://NPDIZGXHAP-dsn.algolia.net" crossorigin="anonymous"><link rel="search" type="application/opensearchdescription+xml" title="TigerBeetle Docs" href="/opensearch.xml">

<script src="https://plausible.io/js/script.js" defer="defer" data-domain="docs.tigerbeetle.com"></script><link rel="stylesheet" href="/assets/css/styles.2402893a.css">
<link rel="preload" href="/assets/js/runtime~main.ff34022b.js" as="script">
<link rel="preload" href="/assets/js/main.cd7ba56c.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TigerBeetle Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TigerBeetle Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TigerBeetle Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tigerbeetle/tigerbeetle" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">TigerBeetle Docs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/installation">Installation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/quick-start/">Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/design/data-modeling">Design</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/design/data-modeling">Data Modeling</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/design/two-phase-transfers">Two-Phase Transfers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/design/client-requests">Client Requests</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/design/client-sessions">Client Sessions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/design/consistency">Consistency</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/design/time">Time</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/deploy/hardware">Deploy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/recipes/close-account">Recipes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/clients/dotnet">Client Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/reference/accounts">Reference</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FAQ">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/internals/">Internals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internals&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Design</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Data Modeling</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Data Modeling</h1><p>TigerBeetle is a domain-specific database — its schema of <a href="/reference/accounts"><code>Account</code>s</a> and
<a href="/reference/transfers"><code>Transfer</code>s</a> is built-in and fixed. In return for this prescriptive
design, it provides excellent performance, integrated business logic, and powerful invariants.</p><p>This section is a sample of techniques for mapping your application&#x27;s requirements onto
TigerBeetle&#x27;s data model. Which (if any) of these techniques are suitable is highly
application-specific.</p><p>When possible, round trips and coordination can be minimized by encoding application invariants
directly in TigerBeetle rather than implementing them in the application itself (or with a foreign
database). This is useful for both maintaining consistency and performance.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="debits-vs-credits">Debits vs Credits<a href="#debits-vs-credits" class="hash-link" aria-label="Direct link to Debits vs Credits" title="Direct link to Debits vs Credits">​</a></h2><p>TigerBeetle tracks each account&#x27;s cumulative posted debits and cumulative posted credits. In
double-entry accounting, an account balance is the difference between the two — computed as either
<code>debits - credits</code> or <code>credits - debits</code> depending on the type of account. It is up to the
application to compute the balance from the cumulative debits/credits.</p><p>From the database&#x27;s perspective the distinction is arbitrary, but accounting conventions recommend
using a certain balance type for certain types of accounts.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debit-balances">Debit Balances<a href="#debit-balances" class="hash-link" aria-label="Direct link to Debit Balances" title="Direct link to Debit Balances">​</a></h3><p><code>balance = debits - credits</code></p><p>By convention, debit balances are used to represent:</p><ul><li>Operator&#x27;s Assets</li><li>Operator&#x27;s Expenses</li></ul><p>To enforce a positive (non-negative) debit balance, use
<a href="/reference/accounts#flagscredits_must_not_exceed_debits"><code>flags.credits_must_not_exceed_debits</code></a>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="credit-balances">Credit Balances<a href="#credit-balances" class="hash-link" aria-label="Direct link to Credit Balances" title="Direct link to Credit Balances">​</a></h3><p><code>balance = credits - debits</code></p><p>By convention, credit balances are used to represent:</p><ul><li>Operators&#x27;s Liabilities</li><li>Equity in the Operator&#x27;s Business</li><li>Operator&#x27;s Income</li></ul><p>To enforce a positive (non-negative) credit balance, use
<a href="/reference/accounts#flagsdebits_must_not_exceed_credits"><code>flags.debits_must_not_exceed_credits</code></a>.
For example, a customer account that is represented as an Operator&#x27;s Liability would use this flag
to ensure that the balance cannot go negative.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="example">Example<a href="#example" class="hash-link" aria-label="Direct link to Example" title="Direct link to Example">​</a></h3><p>For example, if TigerBeetle is operated by a bank, with customers Alice and Bob, its ledger might
look something like this:</p><table><thead><tr><th align="left">Account Owner</th><th align="right">Debits Posted</th><th align="right">Credits Posted</th><th align="left">Flags</th></tr></thead><tbody><tr><td align="left">Bank</td><td align="right">30</td><td align="right">0</td><td align="left"><code>credits_must_not_exceed_debits</code></td></tr><tr><td align="left">Alice</td><td align="right">0</td><td align="right">20</td><td align="left"><code>debits_must_not_exceed_credits</code></td></tr><tr><td align="left">Bob</td><td align="right">0</td><td align="right">10</td><td align="left"><code>debits_must_not_exceed_credits</code></td></tr></tbody></table><ul><li>The bank has a total of $30 in assets.</li><li>Alice and Bob have deposited money ($20 and $10 respectively) in the bank — from the bank&#x27;s
perspective this is a liability.</li><li>Alice and Bob cannot &quot;overdraw&quot; their account — that is, their balance will never be negative.</li><li>A transfer from Alice to Bob would debit Alice&#x27;s account and credit Bob&#x27;s (decreasing the bank&#x27;s
liability to Alice while increasing the bank&#x27;s liability to Bob).</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fractional-amounts-and-asset-scale">Fractional Amounts and Asset Scale<a href="#fractional-amounts-and-asset-scale" class="hash-link" aria-label="Direct link to Fractional Amounts and Asset Scale" title="Direct link to Fractional Amounts and Asset Scale">​</a></h2><p>To maximize precision and efficiency, <a href="/reference/accounts"><code>Account</code></a> debits/credits
and <a href="/reference/transfers"><code>Transfer</code></a> amounts are unsigned 128-bit integers.
However, currencies are often denominated in fractional amounts.</p><p>To represent a fractional amount in TigerBeetle, <strong>map the smallest useful unit of the fractional
currency to 1</strong>. Consider all amounts in TigerBeetle as a multiple of that unit.</p><p>Applications may rescale the integer amounts as necessary when rendering or interfacing with other
systems. But when working with fractional amounts, calculations should be performed on the integers
to avoid loss of precision due to floating-point approximations.</p><p>TigerBeetle stores information precisely and efficiently, while applications can still
present fractional amounts to their users in a way that they are familiar with seeing them.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="asset-scale">Asset Scale<a href="#asset-scale" class="hash-link" aria-label="Direct link to Asset Scale" title="Direct link to Asset Scale">​</a></h3><p>When the multiplier is a power of 10 (e.g. <code>10 ^ n</code>), then the exponent <code>n</code> is referred to as an
<em>asset scale</em>. For example, representing USD in cents uses an asset scale of <code>2</code>.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h3><ul><li>In USD, <code>$1</code> = <code>100</code> cents. So for example,<ul><li>The fractional amount <code>$0.45</code> is represented as the integer <code>45</code>.</li><li>The fractional amount <code>$123.00</code> is represented as the integer <code>12300</code>.</li><li>The fractional amount <code>$123.45</code> is represented as the integer <code>12345</code>.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="oversized-amounts">Oversized Amounts<a href="#oversized-amounts" class="hash-link" aria-label="Direct link to Oversized Amounts" title="Direct link to Oversized Amounts">​</a></h3><p>The other direction works as well. If the smallest useful unit of a currency is <code>10,000,000 ¤</code>,
then it can be scaled down to the integer <code>1</code>.</p><p>The 128-bit representation defines the precision, but not the scale.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="user_data"><code>user_data</code><a href="#user_data" class="hash-link" aria-label="Direct link to user_data" title="Direct link to user_data">​</a></h2><p><code>user_data_128</code>, <code>user_data_64</code> and <code>user_data_32</code> are the most flexible fields in the schema (for
both <a href="/reference/accounts">accounts</a> and <a href="/reference/transfers">transfers</a>). Each
<code>user_data</code> field&#x27;s contents are arbitrary, interpreted only by the application.</p><p>Each <code>user_data</code> field is indexed for efficient point and range queries.</p><p>While the usage of each field is entirely up to you, one way of thinking about each of the fields
is:</p><ul><li><code>user_data_128</code> - this might store the &quot;who&quot; and/or &quot;what&quot; of a transfer. For example, it could be
a pointer to a business entity stored within the <a href="https://en.wikipedia.org/wiki/Control_plane" target="_blank" rel="noopener noreferrer">control
plane</a> database.</li><li><code>user_data_64</code> - this might store a second timestamp for &quot;when&quot; the transaction originated in the
real world, rather than when the transfer was <a href="/design/time#why-tigerbeetle-manages-timestamps">timestamped by
TigerBeetle</a>. This can be used if you need to model
<a href="https://en.wikipedia.org/wiki/Bitemporal_modeling" target="_blank" rel="noopener noreferrer">bitemporality</a>. Alternatively, if you do not
need this to be used for a timestamp, you could use this field in place of the <code>user_data_128</code> to
store the &quot;who&quot;/&quot;what&quot;.</li><li><code>user_data_32</code> - this might store the &quot;where&quot; of a transfer. For example, it could store the
jurisdiction where the transaction originated in the real world. In certain cases, such as for
cross-border remittances, it might not be enough to have the UTC timestamp and you may want to
know the transfer&#x27;s locale.</li></ul><p>(Note that the <a href="#code"><code>code</code></a> can be used to encode the &quot;why&quot; of a transfer.)</p><p>Any of the <code>user_data</code> fields can be used as a group identifier for objects that will be queried
together. For example, for multiple transfers used for <a href="/recipes/currency-exchange">currency
exchange</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="id"><code>id</code><a href="#id" class="hash-link" aria-label="Direct link to id" title="Direct link to id">​</a></h2><p>The <code>id</code> field uniquely identifies each <a href="/reference/accounts#id"><code>Account</code></a> and
<a href="/reference/transfers#id"><code>Transfer</code></a> within the cluster.</p><p>The primary purpose of an <code>id</code> is to serve as an &quot;idempotency key&quot; — to avoid executing an event
twice. For example, if a client creates a transfer but the server&#x27;s reply is lost, the client (or
application) will retry — the database must not transfer the money twice.</p><p>Note that <code>id</code>s are unique per cluster -- not per ledger. You should attach a separate identifier in
the <a href="#user_data"><code>user_data</code></a> field if you want to store a connection between multiple <code>Account</code>s or
multiple <code>Transfer</code>s that are related to one another. For example, different currency <code>Account</code>s
belonging to the same user or multiple <code>Transfer</code>s that are part of a <a href="/recipes/currency-exchange">currency
exchange</a>.</p><p><a href="#tigerbeetle-time-based-identifiers-recommended">TigerBeetle Time-Based Identifiers</a> are
recommended for most applications.</p><p>When selecting an <code>id</code> scheme:</p><ul><li>Idempotency is particularly important (and difficult) in the context of <a href="/design/consistency#consistency-with-foreign-databases">application crash
recovery</a>.</li><li>Be careful to <a href="https://en.wikipedia.org/wiki/Birthday_problem" target="_blank" rel="noopener noreferrer">avoid <code>id</code> collisions</a>.</li><li>An account and a transfer may share the same <code>id</code> (they belong to different &quot;namespaces&quot;), but
this is not recommended because other systems (that you may later connect to TigerBeetle) may use
a single &quot;namespace&quot; for all objects.</li><li>Avoid requiring a central oracle to generate each unique <code>id</code> (e.g. an auto-increment field in
SQL). A central oracle may become a performance bottleneck when creating accounts/transfers.</li><li>Sequences of identifiers with long runs of strictly increasing (or strictly decreasing) values are
amenable to optimization, leading to higher database throughput.</li><li>Random identifiers are not recommended – they can&#x27;t take advantage of all of the LSM
optimizations. (Random identifiers have ~10% lower throughput than strictly-increasing ULIDs).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="tigerbeetle-time-based-identifiers-recommended">TigerBeetle Time-Based Identifiers (Recommended)<a href="#tigerbeetle-time-based-identifiers-recommended" class="hash-link" aria-label="Direct link to TigerBeetle Time-Based Identifiers (Recommended)" title="Direct link to TigerBeetle Time-Based Identifiers (Recommended)">​</a></h3><p>TigerBeetle recommends using a specific ID scheme for most applications. It is time-based and
lexicographically sortable. The scheme is inspired by ULIDs and UUIDv7s but is better able to take
advantage of LSM optimizations, which leads to higher database throughput.</p><p>TigerBeetle clients include an <code>id()</code> function to generate IDs using the recommended scheme.</p><p>TigerBeetle IDs consist of:</p><ul><li>48 bits of (millisecond) timestamp (high-order bits)</li><li>80 bits of randomness (low-order bits)</li></ul><p>When creating multiple objects during the same millisecond, we increment the random bytes rather
than generating new random bytes. Furthermore, it is important that IDs are stored in little-endian
with the random bytes as the lower-order bits and the timestamp as the higher-order bits. These
details ensure that a sequence of objects have strictly increasing IDs according to the server,
which improves database optimization.</p><p>Similar to ULIDs and UUIDv7s, these IDs have the following benefits:</p><ul><li>they have an insignificant risk of collision.</li><li>they do not require a central oracle to generate.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reuse-foreign-identifier">Reuse Foreign Identifier<a href="#reuse-foreign-identifier" class="hash-link" aria-label="Direct link to Reuse Foreign Identifier" title="Direct link to Reuse Foreign Identifier">​</a></h3><p>This technique is most appropriate when integrating TigerBeetle with an existing application where
TigerBeetle accounts or transfers map one-to-one with an entity in the foreign database.</p><p>Set <code>id</code> to a &quot;foreign key&quot; — that is, reuse an identifier of a corresponding object from another
database. For example, if every user (within the application&#x27;s database) has a single account, then
the identifier within the foreign database can be used as the <code>Account.id</code> within TigerBeetle.</p><p>To reuse the foreign identifier, it must conform to TigerBeetle&#x27;s <code>id</code>
<a href="/reference/accounts#id">constraints</a>.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ledger"><code>ledger</code><a href="#ledger" class="hash-link" aria-label="Direct link to ledger" title="Direct link to ledger">​</a></h2><p>The <code>ledger</code> identifier on <a href="/reference/accounts#ledger"><code>Account</code>s</a> partitions sets of accounts
that can directly transact with one another. This is used to separate accounts representing
different currencies or other asset types.</p><p><a href="/recipes/currency-exchange">Currency exchange</a> or cross-ledger transfers are implemented with
two or more linked transfers.</p><p>You can also use different ledgers to further partition accounts, beyond asset type. For example, if
you have a multi-tenant setup where you are tracking balances for your customers&#x27; end-users, you
might have a ledger for each of your customers. If customers have end-user accounts in multiple
currencies, each of your customers would have multiple ledgers.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="code"><code>code</code><a href="#code" class="hash-link" aria-label="Direct link to code" title="Direct link to code">​</a></h2><p>The <code>code</code> identifier represents the &quot;why&quot; for an Account or Transfer.</p><p>On an <a href="/reference/accounts#code"><code>Account</code></a>, the <code>code</code> indicates the account type, such as
assets, liabilities, equity, income, or expenses, and subcategories within those classification.</p><p>On a <a href="/reference/transfers#code"><code>Transfer</code></a>, the <code>code</code> indicates why a given transfer is
happening, such as a purchase, refund, currency exchange, etc.</p><p>When you start building out your application on top of TigerBeetle, you may find it helpful to list
out all of the known types of accounts and movements of funds and mapping each of these to <code>code</code>
numbers or ranges.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tigerbeetle/tigerbeetle/blob/main/docs/design/data-modeling.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/quick-start/cli-repl"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Use the CLI REPL to Create Accounts and Transfers</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/design/two-phase-transfers"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Two-Phase Transfers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#debits-vs-credits" class="table-of-contents__link toc-highlight">Debits vs Credits</a><ul><li><a href="#debit-balances" class="table-of-contents__link toc-highlight">Debit Balances</a></li><li><a href="#credit-balances" class="table-of-contents__link toc-highlight">Credit Balances</a></li><li><a href="#example" class="table-of-contents__link toc-highlight">Example</a></li></ul></li><li><a href="#fractional-amounts-and-asset-scale" class="table-of-contents__link toc-highlight">Fractional Amounts and Asset Scale</a><ul><li><a href="#asset-scale" class="table-of-contents__link toc-highlight">Asset Scale</a></li><li><a href="#examples" class="table-of-contents__link toc-highlight">Examples</a></li><li><a href="#oversized-amounts" class="table-of-contents__link toc-highlight">Oversized Amounts</a></li></ul></li><li><a href="#user_data" class="table-of-contents__link toc-highlight"><code>user_data</code></a></li><li><a href="#id" class="table-of-contents__link toc-highlight"><code>id</code></a><ul><li><a href="#tigerbeetle-time-based-identifiers-recommended" class="table-of-contents__link toc-highlight">TigerBeetle Time-Based Identifiers (Recommended)</a></li><li><a href="#reuse-foreign-identifier" class="table-of-contents__link toc-highlight">Reuse Foreign Identifier</a></li></ul></li><li><a href="#ledger" class="table-of-contents__link toc-highlight"><code>ledger</code></a></li><li><a href="#code" class="table-of-contents__link toc-highlight"><code>code</code></a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/tigerbeetledb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/tigerbeetle/tigerbeetle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/company/tigerbeetle" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://slack.tigerbeetle.com/invite" target="_blank" rel="noopener noreferrer" class="footer__link-item">Slack<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 TigerBeetle, Inc. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ff34022b.js"></script>
<script src="/assets/js/main.cd7ba56c.js"></script>
</body>
</html>