<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-reference/transfers">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Transfers | TigerBeetle Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.tigerbeetle.com/reference/transfers"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Transfers | TigerBeetle Docs"><meta data-rh="true" name="description" content="A transfer is an immutable record of a financial transaction between"><meta data-rh="true" property="og:description" content="A transfer is an immutable record of a financial transaction between"><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://docs.tigerbeetle.com/reference/transfers"><link data-rh="true" rel="alternate" href="https://docs.tigerbeetle.com/reference/transfers" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.tigerbeetle.com/reference/transfers" hreflang="x-default"><script src="https://plausible.io/js/script.js" defer="defer" data-domain="docs.tigerbeetle.com"></script><link rel="stylesheet" href="/assets/css/styles.87e3d320.css">
<link rel="preload" href="/assets/js/runtime~main.9791f769.js" as="script">
<link rel="preload" href="/assets/js/main.b24ac8cd.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="TigerBeetle Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="TigerBeetle Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">TigerBeetle Docs</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/tigerbeetledb/tigerbeetle" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">TigerBeetle Docs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/quick-start/">Quick Start</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quick Start&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/design/client-requests">Design</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/deploy/hardware">Deploy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/recipes/close-account">Recipes</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/clients/dotnet">Client Libraries</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/reference/accounts">Reference</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/accounts">Accounts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/reference/transfers">Transfers</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/reference/operations/">Operations</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operations&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/FAQ">FAQ</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/internals/">Internals</a><button aria-label="Toggle the collapsible sidebar category &#x27;Internals&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Reference</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Transfers</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Transfers</h1><p>A <code>transfer</code> is an immutable record of a financial transaction between
two accounts.</p><p>In TigerBeetle, financial transactions are called &quot;transfers&quot; instead of &quot;transactions&quot; because
the latter term is heavily overloaded in the context of databases.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="updates">Updates<a href="#updates" class="hash-link" aria-label="Direct link to Updates" title="Direct link to Updates">​</a></h3><p>Transfers <em>cannot be modified</em> after creation.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="modes">Modes<a href="#modes" class="hash-link" aria-label="Direct link to Modes" title="Direct link to Modes">​</a></h2><p>Fields used by each mode of transfer:</p><table><thead><tr><th>Field</th><th>Single-Phase</th><th>Pending</th><th>Post-Pending</th><th>Void-Pending</th></tr></thead><tbody><tr><td><code>id</code></td><td>required</td><td>required</td><td>required</td><td>required</td></tr><tr><td><code>debit_account_id</code></td><td>required</td><td>required</td><td>optional</td><td>optional</td></tr><tr><td><code>credit_account_id</code></td><td>required</td><td>required</td><td>optional</td><td>optional</td></tr><tr><td><code>user_data</code></td><td>optional</td><td>optional</td><td>optional</td><td>optional</td></tr><tr><td><code>reserved</code></td><td>none</td><td>none</td><td>none</td><td>none</td></tr><tr><td><code>pending_id</code></td><td>none</td><td>none</td><td>required</td><td>required</td></tr><tr><td><code>timeout</code></td><td>none</td><td>optional</td><td>none</td><td>none</td></tr><tr><td><code>ledger</code></td><td>required</td><td>required</td><td>optional</td><td>optional</td></tr><tr><td><code>code</code></td><td>required</td><td>required</td><td>optional</td><td>optional</td></tr><tr><td><code>flags.linked</code></td><td>optional</td><td>optional</td><td>optional</td><td>optional</td></tr><tr><td><code>flags.pending</code></td><td>false</td><td>true</td><td>false</td><td>false</td></tr><tr><td><code>flags.post_pending_transfer</code></td><td>false</td><td>false</td><td>true</td><td>false</td></tr><tr><td><code>flags.void_pending_transfer</code></td><td>false</td><td>false</td><td>false</td><td>true</td></tr><tr><td><code>flags.balancing_debit</code></td><td>optional</td><td>optional</td><td>false</td><td>false</td></tr><tr><td><code>flags.balancing_credit</code></td><td>optional</td><td>optional</td><td>false</td><td>false</td></tr><tr><td><code>amount</code></td><td>required</td><td>required</td><td>optional</td><td>optional</td></tr><tr><td><code>timestamp</code></td><td>none</td><td>none</td><td>none</td><td>none</td></tr></tbody></table><p>TigerBeetle uses the same data structures internally and
externally. This means that sometimes you need to set temporary values
for fields that TigerBeetle, not you (the user), are responsible.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-phase-transfer">Single-phase transfer<a href="#single-phase-transfer" class="hash-link" aria-label="Direct link to Single-phase transfer" title="Direct link to Single-phase transfer">​</a></h3><p>Single-phase transfers post funds to accounts immediately when they are created.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="two-phase-transfer">Two-phase transfer<a href="#two-phase-transfer" class="hash-link" aria-label="Direct link to Two-phase transfer" title="Direct link to Two-phase transfer">​</a></h3><p>A pending transfer followed by a post-pending transfer, void-pending transfer, or a timeout is
called a &quot;two-phase transfer&quot;. Unlike a single-phase transfer, a two-phase transfer moves funds in
stages:</p><ol><li>Reserve funds</li><li>Resolve funds (post, void, or timeout)</li></ol><p>Attempting to resolve a pending transfer more than once will return the applicable error result:</p><ul><li><a href="/reference/operations/create_transfers#pending_transfer_already_posted"><code>pending_transfer_already_posted</code></a></li><li><a href="/reference/operations/create_transfers#pending_transfer_already_voided"><code>pending_transfer_already_voided</code></a></li><li><a href="/reference/operations/create_transfers#pending_transfer_expired"><code>pending_transfer_expired</code></a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="pending-transfer">Pending transfer<a href="#pending-transfer" class="hash-link" aria-label="Direct link to Pending transfer" title="Direct link to Pending transfer">​</a></h4><p>A pending transfer, denoted by <a href="#flagspending"><code>flags.pending</code></a>,
reserves its <code>amount</code> in the debit/credit accounts&#x27;
<a href="/reference/accounts#debits_pending"><code>debits_pending</code></a>/<a href="/reference/accounts#credits_pending"><code>credits_pending</code></a>
fields respectively, leaving <code>debits_posted</code>/<code>credits_posted</code> unmodified.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="post-pending-transfer">Post-pending transfer<a href="#post-pending-transfer" class="hash-link" aria-label="Direct link to Post-pending transfer" title="Direct link to Post-pending transfer">​</a></h4><p>A post-pending transfer, denoted by <a href="#flagspost_pending_transfer"><code>flags.post_pending_transfer</code></a>,
causes the corresponding pending transfer (referenced by <a href="#pending_id"><code>pending_id</code></a>) to &quot;post&quot;,
transferring some or all of the pending transfer&#x27;s reserved amount to its destination, and restoring
(voiding) the remainder (if any) to its origin accounts.</p><ul><li>If the posted <code>amount</code> is 0, the full pending transfer&#x27;s amount is
posted.</li><li>If the posted <code>amount</code> is nonzero, then only this amount is posted,
and the remainder is restored to its original accounts. It must be
less than or equal to the pending transfer&#x27;s amount.</li></ul><p>Additionally, when <code>flags.post_pending_transfer</code> is set:</p><ul><li><code>pending_id</code> must reference a <a href="#pending-transfer">pending transfer</a>.</li><li><code>flags.void_pending_transfer</code> must not be set.</li></ul><p>And the following fields may either be zero, otherwise must match the
value of the pending transfer&#x27;s field:</p><ul><li><code>debit_account_id</code></li><li><code>credit_account_id</code></li><li><code>ledger</code></li><li><code>code</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="void-pending-transfer">Void-pending transfer<a href="#void-pending-transfer" class="hash-link" aria-label="Direct link to Void-pending transfer" title="Direct link to Void-pending transfer">​</a></h4><p>A void-pending transfer, denoted by <a href="#flagsvoid_pending_transfer"><code>flags.void_pending_transfer</code></a>,
causes the pending transfer (referenced by <a href="#pending_id"><code>pending_id</code></a>) to void. The pending amount
is restored to its original accounts.
Additionally, when this field is set:</p><ul><li><code>pending_id</code> must reference a <a href="#pending-transfer">pending transfer</a>.</li><li><code>flags.post_pending_transfer</code> must not be set.</li></ul><p>And the following fields may either be zero, otherwise must match the
value of the pending transfer&#x27;s field:</p><ul><li><code>debit_account_id</code></li><li><code>credit_account_id</code></li><li><code>ledger</code></li><li><code>code</code></li><li><code>amount</code></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="read-more">Read more<a href="#read-more" class="hash-link" aria-label="Direct link to Read more" title="Direct link to Read more">​</a></h4><p>See the <a href="/design/two-phase-transfers">Two-phase transfers</a> guide
for details, examples, and sample code.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="fields">Fields<a href="#fields" class="hash-link" aria-label="Direct link to Fields" title="Direct link to Fields">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="id"><code>id</code><a href="#id" class="hash-link" aria-label="Direct link to id" title="Direct link to id">​</a></h3><p>This is a unique identifier for the transaction.</p><p>As an example, you might generate a <a href="/design/data-modeling#random-identifier">random id</a> to
identify each transaction.</p><p>Constraints:</p><ul><li>Type is 128-bit unsigned integer (16 bytes)</li><li>Must not be zero or <code>2^128 - 1</code></li><li>Must not conflict with another transfer</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="debit_account_id"><code>debit_account_id</code><a href="#debit_account_id" class="hash-link" aria-label="Direct link to debit_account_id" title="Direct link to debit_account_id">​</a></h3><p>This refers to the account to debit the transfer&#x27;s <a href="#amount"><code>amount</code></a>.</p><p>Constraints:</p><ul><li>Type is 128-bit unsigned integer (16 bytes)</li><li>When <code>flags.post_pending_transfer</code> and <code>flags.void_pending_transfer</code> are unset:<ul><li>Must match an existing account</li><li>Must not be the same as <code>credit_account_id</code></li></ul></li><li>When <code>flags.post_pending_transfer</code> or <code>flags.void_pending_transfer</code> are set:<ul><li>If <code>debit_account_id</code> is zero, it will be automatically set to the pending transfer&#x27;s
<code>debit_account_id</code>.</li><li>If <code>debit_account_id</code> is nonzero, it must match the corresponding pending transfer&#x27;s
<code>debit_account_id</code>.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="credit_account_id"><code>credit_account_id</code><a href="#credit_account_id" class="hash-link" aria-label="Direct link to credit_account_id" title="Direct link to credit_account_id">​</a></h3><p>This refers to the account to credit the transfer&#x27;s <a href="#amount"><code>amount</code></a>.</p><p>Constraints:</p><ul><li>Type is 128-bit unsigned integer (16 bytes)</li><li>When <code>flags.post_pending_transfer</code> and <code>flags.void_pending_transfer</code> are unset:<ul><li>Must match an existing account</li><li>Must not be the same as <code>debit_account_id</code></li></ul></li><li>When <code>flags.post_pending_transfer</code> or <code>flags.void_pending_transfer</code> are set:<ul><li>If <code>credit_account_id</code> is zero, it will be automatically set to the pending transfer&#x27;s
<code>credit_account_id</code>.</li><li>If <code>credit_account_id</code> is nonzero, it must match the corresponding pending transfer&#x27;s
<code>credit_account_id</code>.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="user_data"><code>user_data</code><a href="#user_data" class="hash-link" aria-label="Direct link to user_data" title="Direct link to user_data">​</a></h3><p>This is an optional secondary identifier to link this transfer to an
external entity.</p><p>As an example, you might use a <a href="/design/data-modeling#random-identifier">random id</a> that ties
together a group of transfers.</p><p>For more information, see <a href="/design/data-modeling#user_data">Data Modeling</a>.</p><p>Constraints:</p><ul><li>Type is 128-bit unsigned integer (16 bytes)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="reserved"><code>reserved</code><a href="#reserved" class="hash-link" aria-label="Direct link to reserved" title="Direct link to reserved">​</a></h3><p>This space may be used for additional data in the future.</p><p>Constraints:</p><ul><li>Type is 128-bit unsigned integer (16 bytes)</li><li>Must be zero</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="pending_id"><code>pending_id</code><a href="#pending_id" class="hash-link" aria-label="Direct link to pending_id" title="Direct link to pending_id">​</a></h3><p>If this transfer will post or void a pending transfer, <code>pending_id</code>
references that pending transfer. If this is not a post or void
transfer, it must be zero.</p><p>See also:</p><ul><li><a href="#pending-transfer">Pending Transfer</a></li><li><a href="#post-pending-transfer">Post-Pending Transfer</a></li><li><a href="#void-pending-transfer">Void-Pending Transfer</a></li></ul><p>Constraints:</p><ul><li>Type is 128-bit unsigned integer (16 bytes)</li><li>Must be zero if neither void nor pending transfer flag is set</li><li>Must match an existing transfer&#x27;s <a href="#id"><code>id</code></a> if non-zero</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="timeout"><code>timeout</code><a href="#timeout" class="hash-link" aria-label="Direct link to timeout" title="Direct link to timeout">​</a></h3><p>This is the interval (in nanoseconds) after a
<a href="#flagspending"><code>pending</code></a> transfer&#x27;s <a href="#timestamp">arrival at the cluster</a>
that it may be posted or voided. Zero denotes absence of timeout.</p><p>If the timeout expires and the pending transfer has not already been
posted or voided, the pending transfer is voided automatically.</p><p>Non-pending transfers cannot have a timeout.</p><p>Constraints:</p><ul><li>Type is 64-bit unsigned integer (8 bytes)</li><li>Must be zero if <code>flags.pending</code> is <em>not</em> set</li><li>Must not overflow a 64-bit unsigned integer when summed with the transfer&#x27;s timestamp
(<code>error.overflows_timeout</code>)</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ledger"><code>ledger</code><a href="#ledger" class="hash-link" aria-label="Direct link to ledger" title="Direct link to ledger">​</a></h3><p>This is an identifier that partitions the sets of accounts that can
transact with each other. Put another way, money cannot transfer
between two accounts with different <code>ledger</code> values. See:
<a href="/reference/operations/create_transfers#accounts_must_have_the_same_ledger"><code>accounts_must_have_the_same_ledger</code></a>.</p><p><a href="/recipes/currency-exchange">Currency exchange</a> is implemented with two or more linked
transfers.</p><p>Constraints:</p><ul><li>Type is 32-bit unsigned integer (4 bytes)</li><li>When <code>flags.post_pending_transfer</code> or <code>flags.void_pending_transfer</code> is set:<ul><li>If <code>ledger</code> is zero, it will be automatically be set to the pending transfer&#x27;s <code>ledger</code>.</li><li>If <code>ledger</code> is nonzero, it must match the <code>ledger</code> value on the pending transfer&#x27;s
<code>debit_account_id</code> <strong>and</strong> <code>credit_account_id</code>.</li></ul></li><li>When <code>flags.post_pending_transfer</code> and <code>flags.void_pending_transfer</code> are not set:<ul><li><code>ledger</code> must not be zero.</li><li><code>ledger</code> must match the <code>ledger</code> value on the accounts referenced in
<code>debit_account_id</code> <strong>and</strong> <code>credit_account_id</code>.</li></ul></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="code"><code>code</code><a href="#code" class="hash-link" aria-label="Direct link to code" title="Direct link to code">​</a></h3><p>This is a user-defined enum denoting the reason for (or category of) the
transfer.</p><p>Constraints:</p><ul><li>Type is 16-bit unsigned integer (2 bytes)</li><li>When <code>flags.post_pending_transfer</code> or <code>flags.void_pending_transfer</code> is set:<ul><li>If <code>code</code> is zero, it will be automatically be set to the pending transfer&#x27;s <code>code</code>.</li><li>If <code>code</code> is nonzero, it must match the pending transfer&#x27;s <code>code</code>.</li></ul></li><li>When <code>flags.post_pending_transfer</code> and <code>flags.void_pending_transfer</code> are not set, <code>code</code> must not
be zero.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="flags"><code>flags</code><a href="#flags" class="hash-link" aria-label="Direct link to flags" title="Direct link to flags">​</a></h3><p>This specifies (optional) transfer behavior.</p><p>Constraints:</p><ul><li>Type is 16-bit unsigned integer (2 bytes)</li><li>Some flags are mutually exclusive; see
<a href="/reference/operations/create_transfers#flags_are_mutually_exclusive"><code>flags_are_mutually_exclusive</code></a>.</li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flagslinked"><code>flags.linked</code><a href="#flagslinked" class="hash-link" aria-label="Direct link to flagslinked" title="Direct link to flagslinked">​</a></h4><p>When the <code>linked</code> flag is specified, it links a transfer with the next
transfer in the batch, to create a chain of transfers, of arbitrary
length, which all succeed or fail in creation together. The tail of a
chain is denoted by the first transfer without this flag. The last
transfer in a batch may therefore never have <code>flags.linked</code> set as
this would leave a chain open-ended (see <code>linked_event_chain_open</code>).</p><p>Multiple chains of individual transfers may coexist within a batch to
succeed or fail independently. Transfers within a chain are executed
within order, or are rolled back on error, so that the effect of each
transfer in the chain is visible to the next, and so that the chain is
either visible or invisible as a unit to subsequent transfers after the
chain. The transfer that was the first to break the chain will have a
unique error result. Other transfers in the chain will have their error
result set to
<a href="/reference/operations/create_transfers#linked_event_failed"><code>linked_event_failed</code></a>.</p><p>Consider this set of transfers as part of a batch:</p><table><thead><tr><th>Transfer</th><th>Index within batch</th><th>flags.linked</th></tr></thead><tbody><tr><td><code>A</code></td><td><code>0</code></td><td><code>false</code></td></tr><tr><td><code>B</code></td><td><code>1</code></td><td><code>true</code></td></tr><tr><td><code>C</code></td><td><code>2</code></td><td><code>true</code></td></tr><tr><td><code>D</code></td><td><code>3</code></td><td><code>false</code></td></tr><tr><td><code>E</code></td><td><code>4</code></td><td><code>false</code></td></tr></tbody></table><p>If any of transfers <code>B</code>, <code>C</code>, or <code>D</code> fail (for example, due to
<a href="/reference/operations/create_transfers#exceeds_credits"><code>exceeds_credits</code></a>,
then <code>B</code>, <code>C</code>, and <code>D</code> will all fail. They are linked.</p><p>Transfers <code>A</code> and <code>E</code> fail or succeed independently of <code>B</code>, <code>C</code>, <code>D</code>,
and each other.</p><p>After the link has executed, the association of each event is lost.
To save the association, it must be
<a href="/design/data-modeling">encoded into the data model</a>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="examples">Examples<a href="#examples" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h5><ul><li><a href="/recipes/currency-exchange">Currency Exchange</a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flagspending"><code>flags.pending</code><a href="#flagspending" class="hash-link" aria-label="Direct link to flagspending" title="Direct link to flagspending">​</a></h4><p>Mark the transfer as a <a href="#pending-transfer">pending transfer</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flagspost_pending_transfer"><code>flags.post_pending_transfer</code><a href="#flagspost_pending_transfer" class="hash-link" aria-label="Direct link to flagspost_pending_transfer" title="Direct link to flagspost_pending_transfer">​</a></h4><p>Mark the transfer as a <a href="#post-pending-transfer">post-pending transfer</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flagsvoid_pending_transfer"><code>flags.void_pending_transfer</code><a href="#flagsvoid_pending_transfer" class="hash-link" aria-label="Direct link to flagsvoid_pending_transfer" title="Direct link to flagsvoid_pending_transfer">​</a></h4><p>Mark the transfer as a <a href="#void-pending-transfer">void-pending transfer</a>.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flagsbalancing_debit"><code>flags.balancing_debit</code><a href="#flagsbalancing_debit" class="hash-link" aria-label="Direct link to flagsbalancing_debit" title="Direct link to flagsbalancing_debit">​</a></h4><p>Transfer at most <a href="#amount"><code>amount</code></a> — automatically transferring less than <code>amount</code> as necessary
such that <code>debit_account.debits_pending + debit_account.debits_posted ≤ debit_account.credits_posted</code>.
If <code>amount</code> is set to <code>0</code>, transfer at most <code>2^64 - 1</code> (i.e. as much as possible).</p><p>If the highest amount transferable is <code>0</code>, returns
<a href="/reference/operations/create_transfers#exceeds_credits"><code>exceeds_credits</code></a>.</p><p>Retrying a balancing transfer will return
<a href="/reference/operations/create_transfers#exists_with_different_amount"><code>exists_with_different_amount</code></a>
if the amount of the retry differs from the amount that was actually transferred.</p><p>The <code>amount</code> of the recorded transfer is set to the actual amount that was transferred, which is
less than or equal to the amount that was passed to <code>create_transfers</code>.</p><p><code>flags.balancing_debit</code> is exclusive with the <code>flags.post_pending_transfer</code>/<code>flags.void_pending_transfer</code>
flags because posting or voiding a pending transfer will never exceed/overflow either account&#x27;s limits.</p><p><code>flags.balancing_debit</code> is compatible with (and orthogonal to) <code>flags.balancing_credit</code>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="examples-1">Examples<a href="#examples-1" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h5><ul><li><a href="/recipes/close-account">Close Account</a></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="flagsbalancing_credit"><code>flags.balancing_credit</code><a href="#flagsbalancing_credit" class="hash-link" aria-label="Direct link to flagsbalancing_credit" title="Direct link to flagsbalancing_credit">​</a></h4><p>Transfer at most <a href="#amount"><code>amount</code></a> — automatically transferring less than <code>amount</code> as necessary
such that <code>credit_account.credits_pending + credit_account.credits_posted ≤ credit_account.debits_posted</code>.
If <code>amount</code> is set to <code>0</code>, transfer at most <code>2^64 - 1</code> (i.e. as much as possible).</p><p>If the highest amount transferable is <code>0</code>, returns
<a href="/reference/operations/create_transfers#exceeds_debits"><code>exceeds_debits</code></a>.</p><p>Retrying a balancing transfer will return
<a href="/reference/operations/create_transfers#exists_with_different_amount"><code>exists_with_different_amount</code></a>
if the amount of the retry differs from the amount that was actually transferred.</p><p>The <code>amount</code> of the recorded transfer is set to the actual amount that was transferred, which is
less than or equal to the amount that was passed to <code>create_transfers</code>.</p><p><code>flags.balancing_credit</code> is exclusive with the <code>flags.post_pending_transfer</code>/<code>flags.void_pending_transfer</code>
flags because posting or voiding a pending transfer will never exceed/overflow either account&#x27;s limits.</p><p><code>flags.balancing_credit</code> is compatible with (and orthogonal to) <code>flags.balancing_debit</code>.</p><h5 class="anchor anchorWithStickyNavbar_LWe7" id="examples-2">Examples<a href="#examples-2" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h5><ul><li><a href="/recipes/close-account">Close Account</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="amount"><code>amount</code><a href="#amount" class="hash-link" aria-label="Direct link to amount" title="Direct link to amount">​</a></h3><p>This is how much should be debited from the <code>debit_account_id</code> account
and credited to the <code>credit_account_id</code> account.</p><ul><li>When <code>flags.balancing_debit</code> is set, this is the maximum amount that will be debited/credited,
where the actual transfer amount is determined by the debit account&#x27;s constraints.</li><li>When <code>flags.balancing_credit</code> is set, this is the maximum amount that will be debited/credited,
where the actual transfer amount is determined by the credit account&#x27;s constraints.</li></ul><p>Constraints:</p><ul><li>Type is 64-bit unsigned integer (8 bytes)</li><li>When <code>flags.post_pending_transfer</code> is set:<ul><li>If <code>amount</code> is zero, it will be automatically be set to the pending transfer&#x27;s <code>amount</code>.</li><li>If <code>amount</code> is nonzero, it must be less than or equal to the pending transfer&#x27;s <code>amount</code>.</li></ul></li><li>When <code>flags.void_pending_transfer</code> is set:<ul><li>If <code>amount</code> is zero, it will be automatically be set to the pending transfer&#x27;s <code>amount</code>.</li><li>If <code>amount</code> is nonzero, it must be equal to the pending transfer&#x27;s <code>amount</code>.</li></ul></li><li>When <code>flags.balancing_debit</code> and/or <code>flags.balancing_credit</code> is set, if <code>amount</code> is zero,
it will automatically be set to the maximum amount that does not violate the corresponding
account limits. (Equivalent to setting <code>amount = 2^64 - 1</code>).</li><li>When all of the following flags are not set, <code>amount</code> must be nonzero:<ul><li><code>flags.post_pending_transfer</code></li><li><code>flags.void_pending_transfer</code></li><li><code>flags.balancing_debit</code></li><li><code>flags.balancing_credit</code></li></ul></li></ul><h4 class="anchor anchorWithStickyNavbar_LWe7" id="examples-3">Examples<a href="#examples-3" class="hash-link" aria-label="Direct link to Examples" title="Direct link to Examples">​</a></h4><ul><li>For representing fractional amounts (e.g. <code>$12.34</code>), see
<a href="/recipes/fractional-amounts">Fractional Amounts</a>.</li><li>For balancing transfers, see <a href="/recipes/close-account">Close Account</a>.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="timestamp"><code>timestamp</code><a href="#timestamp" class="hash-link" aria-label="Direct link to timestamp" title="Direct link to timestamp">​</a></h3><p>This is the time the transfer was created, as nanoseconds since
UNIX epoch.</p><p>It is set by TigerBeetle to the moment the transfer arrives at
the cluster.</p><p>Additionally, all timestamps are unique, immutable and <a href="http://book.mixu.net/distsys/time.html" target="_blank" rel="noopener noreferrer">totally
ordered</a>. So a transfer that
is created before another transfer is guaranteed to have an earlier
timestamp. In other systems this is also called a &quot;physical&quot;
timestamp, &quot;ingestion&quot; timestamp, &quot;record&quot; timestamp, or &quot;system&quot;
timestamp.</p><p>Constraints:</p><ul><li>Type is 64-bit unsigned integer (8 bytes)</li><li>User sets to zero on creation</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="internals">Internals<a href="#internals" class="hash-link" aria-label="Direct link to Internals" title="Direct link to Internals">​</a></h2><p>If you&#x27;re curious and want to learn more, you can find the source code
for this struct in
<a href="https://github.com/tigerbeetledb/tigerbeetle/blob/main/src/tigerbeetle.zig" target="_blank" rel="noopener noreferrer">src/tigerbeetle.zig</a>. Search
for <code>const Transfer = extern struct {</code>.</p><p>You can find the source code for creating a transfer in
<a href="https://github.com/tigerbeetledb/tigerbeetle/blob/main/src/state_machine.zig" target="_blank" rel="noopener noreferrer">src/state_machine.zig</a>. Search
for <code>fn create_transfer(</code>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/tigerbeetledb/tigerbeetle/blob/main/docs/reference/transfers.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/reference/accounts"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Accounts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/reference/operations/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Operations</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#updates" class="table-of-contents__link toc-highlight">Updates</a></li><li><a href="#modes" class="table-of-contents__link toc-highlight">Modes</a><ul><li><a href="#single-phase-transfer" class="table-of-contents__link toc-highlight">Single-phase transfer</a></li><li><a href="#two-phase-transfer" class="table-of-contents__link toc-highlight">Two-phase transfer</a></li></ul></li><li><a href="#fields" class="table-of-contents__link toc-highlight">Fields</a><ul><li><a href="#id" class="table-of-contents__link toc-highlight"><code>id</code></a></li><li><a href="#debit_account_id" class="table-of-contents__link toc-highlight"><code>debit_account_id</code></a></li><li><a href="#credit_account_id" class="table-of-contents__link toc-highlight"><code>credit_account_id</code></a></li><li><a href="#user_data" class="table-of-contents__link toc-highlight"><code>user_data</code></a></li><li><a href="#reserved" class="table-of-contents__link toc-highlight"><code>reserved</code></a></li><li><a href="#pending_id" class="table-of-contents__link toc-highlight"><code>pending_id</code></a></li><li><a href="#timeout" class="table-of-contents__link toc-highlight"><code>timeout</code></a></li><li><a href="#ledger" class="table-of-contents__link toc-highlight"><code>ledger</code></a></li><li><a href="#code" class="table-of-contents__link toc-highlight"><code>code</code></a></li><li><a href="#flags" class="table-of-contents__link toc-highlight"><code>flags</code></a></li><li><a href="#amount" class="table-of-contents__link toc-highlight"><code>amount</code></a></li><li><a href="#timestamp" class="table-of-contents__link toc-highlight"><code>timestamp</code></a></li></ul></li><li><a href="#internals" class="table-of-contents__link toc-highlight">Internals</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/tigerbeetledb" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://github.com/tigerbeetledb/tigerbeetle" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://linkedin.com/company/tigerbeetle" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discord.gg/uWCGp46uG5" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 TigerBeetle, Inc. All rights reserved.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.9791f769.js"></script>
<script src="/assets/js/main.b24ac8cd.js"></script>
</body>
</html>